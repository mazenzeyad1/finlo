import{G as D,H,I as V,J as z,ɵ as F,c as I,d as n,e as o,h as l,f as s,i as P,B,j as g,K as b,L as v,g as M,M as L,k as r,m as k,l as d,O as A,P as O,C as j,D as q,N as U,Q as E,T as R,o as N,p as y,q as m,r as T,U as Z,u as f,V as $}from"./index-CoAdiQa4.js";import{M as G}from"./money.component-CIEQHy6Q.js";const p=class p{constructor(e){this.http=e}list(e){const{userId:a,...t}=e;return this.http.get("transactions",{params:{userId:a,...t}})}};p.ɵfac=function(a){return new(a||p)(D(H))},p.ɵprov=V({token:p,factory:p.ɵfac,providedIn:"root"});let w=p;const h=class h{constructor(){this.change=new z}emit(){this.change.emit({from:this.from,to:this.to})}};h.ɵfac=function(a){return new(a||h)},h.ɵcmp=F({type:h,selectors:[["ui-date-range"]],outputs:{change:"change"},standalone:!0,features:[I],decls:6,vars:0,consts:[["type","date",3,"change"]],template:function(a,t){a&1&&(n(0,"label"),o(1,"From "),n(2,"input",0),l("change",function(c){return t.from=c.target.value,t.emit()}),s()(),n(3,"label"),o(4,"To "),n(5,"input",0),l("change",function(c){return t.to=c.target.value,t.emit()}),s()())},encapsulation:2});let C=h;function X(u,e){if(u&1){const a=N();n(0,"div",23)(1,"div",24),b(),n(2,"svg",25),g(3,"path",9),s(),v(),n(4,"input",26),l("input",function(i){y(a);const c=m();return T(c.onSearch(i.target.value))})("keyup.enter",function(){y(a);const i=m();return T(i.reload())}),s()()()}}function J(u,e){if(u&1){const a=N();n(0,"div",23)(1,"label",27)(2,"span"),o(3,"Date range"),s(),n(4,"ui-date-range",28),l("change",function(i){y(a);const c=m();return T(c.onRange(i))}),s()()()}}function K(u,e){if(u&1&&(n(0,"li",29)(1,"div",30),o(2),s(),n(3,"div",31)(4,"span",32),o(5),s(),n(6,"span",33),o(7),s()(),n(8,"div",34),g(9,"ui-money",35),n(10,"span",36),o(11),L(12,"date"),s()()()),u&2){const a=e.$implicit,t=m();r(),Z("background",t.badgeColor(a)),r(),k(" ",t.badgeLabel(a)," "),r(3),f(a.description),r(2),f(t.subtitleFor(a)),r(),$("negative",a.amount<0),r(),d("amount",a.amount)("currency",a.currency),r(2),f(A(12,10,a.date,"MMM d"))}}const _=class _{constructor(){this.api=P(w),this.store=P(B),this.userId="demo-user",this.page={items:[],total:0,page:1,pageSize:20},this.showSearch=!1,this.showFilters=!1}ngOnInit(){this.reload()}totalPages(){return Math.max(1,Math.ceil(this.page.total/this.page.pageSize))}onSearch(e){this.q=e}onRange(e){this.from=e.from,this.to=e.to}toggleSearch(){this.showSearch=!this.showSearch}toggleFilters(){this.showFilters=!this.showFilters}load(){this.api.list({userId:this.userId,accountId:this.store.selectedAccountId()||void 0,from:this.from,to:this.to,q:this.q,page:this.page.page,pageSize:this.page.pageSize}).subscribe(e=>this.page=e)}reload(){this.page.page=1,this.load()}next(){this.page.page++,this.load()}prev(){this.page.page--,this.load()}selectedAccountLabel(){var e;return((e=this.store.selectedAccount())==null?void 0:e.name)||"All Accounts"}subtitleFor(e){const a=e.date?new Date(e.date):null,t=a?a.toLocaleDateString(void 0,{month:"short",day:"numeric"}):"—";return`${this.accountName(e)||(e.pending?"Pending":"Posted")} · ${t}`}badgeLabel(e){return((this.accountName(e)||e.description||"TX").replace(/[^A-Za-z0-9]/g,"").slice(0,2)||"TX").toUpperCase()}badgeColor(e){const a=["#4c6ef5","#f97316","#0ea5e9","#22c55e","#6366f1"],t=(this.accountName(e)||e.description||"key").toLowerCase();let i=0;for(let c=0;c<t.length;c++)i=(i<<5)-i+t.charCodeAt(c),i|=0;return a[Math.abs(i)%a.length]}accountName(e){var a;return((a=this.store.accounts().find(t=>t.id===e.accountId))==null?void 0:a.name)??null}budgetUsage(){const e=this.page.items.filter(t=>t.amount<0).reduce((t,i)=>t+Math.abs(i.amount),0);return Math.min(100,e/5e3*100)}};_.ɵfac=function(a){return new(a||_)},_.ɵcmp=F({type:_,selectors:[["app-transactions"]],standalone:!0,features:[I],decls:51,vars:12,consts:[[1,"page","transactions-page"],[1,"card","transactions-panel"],[1,"transactions-header"],[1,"helper-text"],["type","button","aria-label","More options",1,"icon-btn"],[1,"transactions-chips"],["type","button",1,"chip","active"],["type","button",1,"chip",3,"click"],["width","14","height","14","viewBox","0 0 20 20","fill","none","aria-hidden","true"],["d","M13.8333 12.5H14.5833L18.3333 16.25L16.25 18.3333L12.5 14.5833V13.8333L12.25 13.5833C11.0417 14.5417 9.5 15.0833 7.83333 15.0833C3.91667 15.0833 0.833333 12 0.833333 8.08333C0.833333 4.16667 3.91667 1.08333 7.83333 1.08333C11.75 1.08333 14.8333 4.16667 14.8333 8.08333C14.8333 9.75 14.2917 11.2917 13.3333 12.5L13.8333 12.5ZM3.83333 8.08333C3.83333 10.375 5.54167 12.0833 7.83333 12.0833C10.125 12.0833 11.8333 10.375 11.8333 8.08333C11.8333 5.79167 10.125 4.08333 7.83333 4.08333C5.54167 4.08333 3.83333 5.79167 3.83333 8.08333Z","fill","currentColor"],["d","M3 5H17","stroke","currentColor","stroke-width","1.6","stroke-linecap","round"],["d","M6 10H14","stroke","currentColor","stroke-width","1.6","stroke-linecap","round"],["d","M9 15H11","stroke","currentColor","stroke-width","1.6","stroke-linecap","round"],["type","button",1,"chip","apply",3,"click"],["class","transactions-controls",4,"ngIf"],[1,"card","transactions-list-card"],[1,"transaction-list"],["class","transaction-item",4,"ngFor","ngForOf"],[1,"transaction-summary"],[1,"summary-label"],[1,"summary-value"],[1,"pagination"],[1,"chip",3,"click","disabled"],[1,"transactions-controls"],[1,"input-wrapper"],["width","16","height","16","viewBox","0 0 20 20","fill","none","aria-hidden","true"],["type","search","placeholder","Search description…",3,"input","keyup.enter"],[1,"input-field",2,"width","100%"],[3,"change"],[1,"transaction-item"],[1,"transaction-icon"],[1,"transaction-details"],[1,"transaction-title"],[1,"transaction-subtitle"],[1,"transaction-value"],[3,"amount","currency"],[1,"transaction-date"]],template:function(a,t){a&1&&(n(0,"section",0)(1,"div",1)(2,"header",2)(3,"div")(4,"h2"),o(5,"Transactions"),s(),n(6,"p",3),o(7,"Latest activity across linked accounts."),s()(),n(8,"button",4),g(9,"span")(10,"span")(11,"span"),s()(),n(12,"div",5)(13,"button",6),o(14),s(),n(15,"button",7),l("click",function(){return t.toggleSearch()}),b(),n(16,"svg",8),g(17,"path",9),s(),o(18," Search "),s(),v(),n(19,"button",7),l("click",function(){return t.toggleFilters()}),b(),n(20,"svg",8),g(21,"path",10)(22,"path",11)(23,"path",12),s(),o(24," Filter "),s(),v(),n(25,"button",13),l("click",function(){return t.reload()}),o(26,"Apply"),s()(),M(27,X,5,0,"div",14)(28,J,5,0,"div",14),s(),n(29,"div",15)(30,"ul",16),M(31,K,13,13,"li",17),s(),n(32,"footer",18)(33,"div",19)(34,"span"),o(35,"Total Budget"),s(),n(36,"small",3),o(37,"Across all linked accounts"),s()(),n(38,"div",20)(39,"strong"),o(40),L(41,"number"),s(),n(42,"span",3),o(43,"used"),s()()()(),n(44,"div",21)(45,"button",22),l("click",function(){return t.prev()}),o(46,"Prev"),s(),n(47,"span",3),o(48),s(),n(49,"button",22),l("click",function(){return t.next()}),o(50,"Next"),s()()()),a&2&&(r(14),k(" ",t.selectedAccountLabel()," "),r(13),d("ngIf",t.showSearch),r(),d("ngIf",t.showFilters),r(3),d("ngForOf",t.page.items),r(9),k("",A(41,9,t.budgetUsage(),"1.0-0"),"%"),r(5),d("disabled",t.page.page<=1),r(3),O("Page ",t.page.page," of ",t.totalPages(),""),r(),d("disabled",t.page.page>=t.totalPages()))},dependencies:[j,q,U,E,R,C,G],encapsulation:2});let S=_;export{S as TransactionsPage};
