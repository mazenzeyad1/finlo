import{E as b,F as g,G as y,H as A,I as v,i as p,z as I,B as w,ɵ as F,c as L,d as e,e as a,f as i,h as x,g as T,k as c,l as f,m as C,C as S,D as E,j,q as B,u as l}from"./index-CoAdiQa4.js";import{M}from"./money.component-CIEQHy6Q.js";function h(u,t){return new Promise(function(n,s){var d=new b({next:function(k){n(k),d.unsubscribe()},error:s,complete:function(){s(new g)}});u.subscribe(d)})}const o=class o{constructor(t){this.http=t}startLink(t){return this.http.post("connections/link/start",t)}exchange(t){return this.http.post("connections/link/exchange",t)}list(t){return this.http.get("connections",{params:{userId:t}})}};o.ɵfac=function(n){return new(n||o)(y(A))},o.ɵprov=v({token:o,factory:o.ɵfac,providedIn:"root"});let m=o;function O(u,t){if(u&1&&(e(0,"article",6)(1,"header",7)(2,"span",8),a(3),i(),e(4,"span",9),a(5),i()(),e(6,"dl",10)(7,"div")(8,"dt"),a(9,"Institution"),i(),e(10,"dd"),a(11),i()(),e(12,"div")(13,"dt"),a(14,"Account #"),i(),e(15,"dd"),a(16),i()()(),e(17,"div",11),j(18,"ui-money",12),i()()),u&2){const n=t.$implicit,s=B();c(3),l(n.name),c(2),l(s.formatType(n.type)),c(6),l(n.connectionId),c(5),l(n.mask||"—"),c(2),f("amount",n.balance)("currency",n.currency)}}const r=class r{formatType(t){return t?t.charAt(0).toUpperCase()+t.slice(1):"Unknown"}constructor(){this.accountApi=p(I),this.connectionApi=p(m),this.store=p(w),this.userId="demo-user",this.isLinking=!1,this.store.accounts().length||this.loadAccounts()}async loadAccounts(){const t=await h(this.accountApi.list(this.userId));this.store.setAccounts(t)}async linkBank(){if(!this.isLinking){this.isLinking=!0;try{await h(this.connectionApi.startLink({userId:this.userId,provider:"plaid"})),await h(this.connectionApi.exchange({userId:this.userId,provider:"plaid",publicToken:"public-token-demo"})),await this.loadAccounts()}catch(t){console.error("Failed to link bank",t)}finally{this.isLinking=!1}}}};r.ɵfac=function(n){return new(n||r)},r.ɵcmp=F({type:r,selectors:[["app-accounts"]],standalone:!0,features:[L],decls:11,vars:3,consts:[[1,"page"],[1,"page-header","accounts-header"],[1,"muted"],["type","button",1,"btn",3,"click","disabled"],[1,"card-grid"],["class","card account-card",4,"ngFor","ngForOf"],[1,"card","account-card"],[1,"card-title-row"],[1,"card-title"],[1,"badge"],[1,"account-meta"],[1,"account-balance"],[3,"amount","currency"]],template:function(n,s){n&1&&(e(0,"section",0)(1,"header",1)(2,"div")(3,"h1"),a(4,"Accounts"),i(),e(5,"p",2),a(6,"A quick look at balances across institutions."),i()(),e(7,"button",3),x("click",function(){return s.linkBank()}),a(8),i()(),e(9,"div",4),T(10,O,19,6,"article",5),i()()),n&2&&(c(7),f("disabled",s.isLinking),c(),C(" ",s.isLinking?"Linking…":"Link new bank"," "),c(2),f("ngForOf",s.store.accounts()))},dependencies:[S,E,M],encapsulation:2});let _=r;export{_ as AccountsPage};
